import{d as y,r as g,o as p,c as m,x as _,w as f,F as P,h as S,f as B,W as D,V as C,X as T,E as h,B as I,Y as v,Z as E,_ as k}from"./index-94373d68.js";const M=y({__name:"index",props:{data:null,columns:null},emits:["onSort"],setup(o,{emit:l}){const r=o;function d({prop:s,order:i}){l("onSort",{prop:s,order:i})}return(s,i)=>{const a=g("el-table-column"),n=g("el-table");return p(),m("div",null,[_(n,{data:o.data,border:"",style:{width:"100%"},"row-key":"id",onSortChange:d},{default:f(()=>[(p(!0),m(P,null,S(r.columns,t=>(p(),B(a,{prop:t.prop,sortable:t.isSort?"custom":!1,label:t.label,"min-width":t.minWidth,width:t.width,fixed:t.fixed,align:t.align||"center"},D({_:2},[t.isCustom?{name:"default",fn:f(c=>[C(s.$slots,t.prop,{row:c.row,column:c.column,index:c.$index})]),key:"0"}:void 0]),1032,["prop","sortable","label","min-width","width","fixed","align"]))),256))]),_:3},8,["data"])])}}});function F({id:o,request:l,callback:r}){T.confirm("是否确认删除本条数据？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{l(o).then(()=>{h.success("删除成功"),r&&r()})}).catch(()=>{})}function V({request:o,immediate:l=!0,initParam:r={},isShowPage:d=!0,dataCallBack:s,afterCallback:i}){const a=I({tableData:[],loading:!1,pagination:{pageIndex:1,pageSize:10,total:0},searchParam:{},totalParam:{},sortParam:{},responseData:null});async function n(){t(),a.loading=!0;const e=await o(a.totalParam);d?(a.tableData=e.list||[],a.pagination.total=e.total||0):a.tableData=e||[];try{s&&(a.tableData=s(a.tableData))}catch(u){console.error(u),h.error("格式化数据错误")}finally{a.loading=!1}i&&i(a.tableData)}l&&v(async()=>{await n()});const t=()=>{a.totalParam={},Object.assign(a.totalParam,r,a.searchParam,d?a.pagination:{},a.sortParam)},c=async e=>{a.sortParam={},a.pagination.pageIndex=1,a.searchParam=e,t(),await n()},b=async({prop:e,order:u})=>{a.sortParam={orderByColumn:k(e),orderByAsc:u==="ascending"},a.pagination.pageIndex=1,t(),await n()},w=async e=>{a.pagination.pageIndex=e,t(),await n()},x=async e=>{a.pagination.pageIndex=1,a.pagination.pageSize=e,t(),await n()};return{...E(a),getTableData:n,changePage:w,search:c,sortChange:b,changeSize:x}}export{M as _,F as d,V as u};
