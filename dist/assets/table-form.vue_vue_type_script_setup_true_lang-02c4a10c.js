import{v as j,a as z}from"./validate-7f781a03.js";import{b as M,c as O,e as P}from"./user-16d39fdd.js";import{m as T}from"./md5-1224e620.js";import{d as A,q as k,B as h,a as t,c as y,x as e,w as l,k as w,r as s,o as c,e as G,z as m,f as U,F as H,h as J,E as x}from"./index-94373d68.js";const K={key:0},Q={class:"dialog-footer"},$=A({__name:"table-form",props:{roleList:null},emits:["refresh"],setup(C,{expose:S,emit:b}){const g=k();let o=k({gender:1,status:!0});const q=h({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:12,message:"密码长度6到20位",trigger:"blur"}],phone:[{validator:j,trigger:"blur"}],email:[{validator:z,trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"blur"}]}),B=d=>{M(d).then(a=>{o.value=Object.assign({},o.value,a)})},n=h({isShow:!1,title:"新增用户",id:null}),N=async d=>{n.isShow=!0,n.title="新增用户",d!=null&&d.id&&(n.id=d.id,n.title="编辑用户",B(d.id))},f=()=>{n.isShow=!1,n.id=null,o.value={gender:1,status:!0}},D=async()=>{g.value&&await g.value.validate(d=>{if(d){let a=o.value;a.id?O({...a}).then(()=>{x.success("操作成功"),f(),b("refresh")}):(a.password=T(a.password),P({...a}).then(()=>{x.success("操作成功"),f(),b("refresh")}))}})};return S({openDialog:N}),(d,a)=>{const p=s("el-input"),u=s("el-form-item"),i=s("el-col"),E=s("el-option"),I=s("el-select"),_=s("el-radio"),V=s("el-radio-group"),L=s("el-row"),F=s("el-form"),v=s("el-button"),R=s("el-dialog");return t(n).isShow?(c(),y("div",K,[e(R,{"model-value":!0,"destroy-on-close":"",title:t(n).title,onClose:f},{footer:l(()=>[G("div",Q,[e(v,{type:"primary",onClick:D},{default:l(()=>[m("确定")]),_:1}),e(v,{onClick:f},{default:l(()=>[m("取消")]),_:1})])]),default:l(()=>[e(F,{model:t(o),ref_key:"formRef",ref:g,rules:t(q),"label-width":"90px"},{default:l(()=>[e(L,null,{default:l(()=>[e(i,{span:12},{default:l(()=>[e(u,{label:"用户名",prop:"username"},{default:l(()=>[e(p,{modelValue:t(o).username,"onUpdate:modelValue":a[0]||(a[0]=r=>t(o).username=r),disabled:!!t(o).id,placeholder:"请输入用户名"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(u,{label:"昵称",prop:"nickname"},{default:l(()=>[e(p,{modelValue:t(o).nickname,"onUpdate:modelValue":a[1]||(a[1]=r=>t(o).nickname=r),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1})]),_:1}),t(o).id?w("",!0):(c(),U(i,{key:0,span:12},{default:l(()=>[e(u,{label:"密码",prop:"password"},{default:l(()=>[e(p,{modelValue:t(o).password,"onUpdate:modelValue":a[2]||(a[2]=r=>t(o).password=r),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})]),_:1})),e(i,{span:12},{default:l(()=>[e(u,{label:"手机号",prop:"phone"},{default:l(()=>[e(p,{modelValue:t(o).phone,"onUpdate:modelValue":a[3]||(a[3]=r=>t(o).phone=r),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(u,{label:"邮箱",prop:"email"},{default:l(()=>[e(p,{modelValue:t(o).email,"onUpdate:modelValue":a[4]||(a[4]=r=>t(o).email=r),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(u,{label:"角色",prop:"roleId"},{default:l(()=>[e(I,{modelValue:t(o).roleId,"onUpdate:modelValue":a[5]||(a[5]=r=>t(o).roleId=r),clearable:"",placeholder:"请选择角色"},{default:l(()=>[(c(!0),y(H,null,J(C.roleList,r=>(c(),U(E,{label:r.name,value:r.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(u,{label:"性别"},{default:l(()=>[e(V,{modelValue:t(o).gender,"onUpdate:modelValue":a[6]||(a[6]=r=>t(o).gender=r)},{default:l(()=>[e(_,{label:1,border:""},{default:l(()=>[m("男")]),_:1}),e(_,{label:0,border:""},{default:l(()=>[m("女")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:12},{default:l(()=>[e(u,{label:"状态"},{default:l(()=>[e(V,{modelValue:t(o).status,"onUpdate:modelValue":a[7]||(a[7]=r=>t(o).status=r)},{default:l(()=>[e(_,{label:!0,border:""},{default:l(()=>[m("启用")]),_:1}),e(_,{label:!1,border:""},{default:l(()=>[m("禁用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])])):w("",!0)}}});export{$ as _};
